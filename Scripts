local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
	Name = "Duck Hub - Type: Script Menu",
	LoadingTitle = "Loading...",
	LoadingSubtitle = "by Duck",
	ConfigurationSaving = { Enabled = false },
	KeySystem = false
})

local HomeTab = Window:CreateTab("Home")

local message = game:HttpGet("https://raw.githubusercontent.com/duckshogun09/DuckHub/refs/heads/main/notice.txt")
HomeTab:CreateParagraph({
	Title = "Latest Announcement",
	Content = message
})

HomeTab:CreateLabel("Version: 1.0.0")

HomeTab:CreateButton({
	Name = "Join Discord",
	Callback = function()
		setclipboard("discord.gg/NF6fZapa3U")
		Rayfield:Notify({
			Title = "Discord",
			Content = "Discord link copied!",
			Duration = 4,
			Image = 6031075938
		})
	end,
})

HomeTab:CreateParagraph({
	Title = "Supported Games",
	Content = table.concat({
		"‚Ä¢ Grow A Garden",
		"‚Ä¢ Blox Fruits",
		"‚Ä¢ Arise Crossover",
		"‚Ä¢ King Legacy"
	}, "\n")
})


local ScriptTab = Window:CreateTab("Scripts")

local scriptsByPlaceId = {
	[126884695634066] = {
		["Speed Hub X"] = [[
			loadstring(game:HttpGet("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", true))()
		]],
		["No Lag Hub"] = [[
			loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/NoLag-id/No-Lag-HUB/refs/heads/main/Loader/LoaderV1.lua"))()
		]]
	},
	[2753915549] = {
		["Speed Hub X"] = [[
			loadstring(game:HttpGet("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", true))()
		]]
	},
	[1234567890] = {
		["Script A"] = [[
			print("ƒê√¢y l√† Script A cho game th·ª© 3")
		]],
		["Script B"] = [[
			print("ƒê√¢y l√† Script B cho game th·ª© 3")
		]]
	}
}

local scripts = scriptsByPlaceId[game.PlaceId]

if scripts then
	for name, code in pairs(scripts) do
		ScriptTab:CreateButton({
			Name = name,
			Callback = function()
				loadstring(code)()
			end,
		})
	end
else
	ScriptTab:CreateParagraph({
		Title = "Notification",
		Content = "Scripts are not available for the current game. See what games the script supports in the Home tab."
	})
end

local ServerTab = Window:CreateTab("Server")

-- Hi·ªÉn th·ªã s·ªë ng∆∞·ªùi ch∆°i
local playerCountLabel = ServerTab:CreateLabel("Players in the server: " .. tostring(#game.Players:GetPlayers()))

game.Players.PlayerAdded:Connect(function()
	playerCountLabel:Set("Players in the server: " .. tostring(#game.Players:GetPlayers()))
end)

game.Players.PlayerRemoving:Connect(function()
	task.wait(0.5)
	playerCountLabel:Set("Players in the server: " .. tostring(#game.Players:GetPlayers()))
end)

-- D·ªãch v·ª•
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")

-- T√¨m server √≠t ng∆∞·ªùi nh·∫•t
local function GetLeastPopulatedServer()
	local leastPlayerCount = math.huge
	local targetServerId = nil
	local cursor = ""
	local url = "https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=2&limit=100"

	while true do
		local success, response = pcall(function()
			return HttpService:GetAsync(url .. "&cursor=" .. cursor)
		end)

		if success then
			local data = HttpService:JSONDecode(response)
			if data and data.data then
				for _, server in ipairs(data.data) do
					if server.id ~= game.JobId and server.playing < server.maxPlayers then
						if server.playing < leastPlayerCount then
							leastPlayerCount = server.playing
							targetServerId = server.id
						end
					end
				end
				if data.nextPageCursor then
					cursor = data.nextPageCursor
					task.wait(0.3)
				else
					break
				end
			else
				break
			end
		else
			break
		end
	end

	return targetServerId
end

-- H√†m hop server √≠t ng∆∞·ªùi nh·∫•t
local function HopToLeastPopulatedServer()
	local serverId = GetLeastPopulatedServer()
	if serverId then
		TeleportService:TeleportToPlaceInstance(game.PlaceId, serverId, Players.LocalPlayer)
	else
		Rayfield:Notify({
			Title = "Server Hop",
			Content = "No low-player server found!",
			Duration = 5
		})
	end
end

-- üîÅ T·ª± ƒë·ªông hop sau 3 gi√¢y
task.delay(3, function()
	HopToLeastPopulatedServer()
end)

-- N√∫t hop th·ªß c√¥ng
ServerTab:CreateButton({
	Name = "Hop Server (least players)",
	Callback = function()
		HopToLeastPopulatedServer()
	end,
})

-- Input JobId ƒë·ªÉ join
ServerTab:CreateInput({
	Name = "Join Server by JobId",
	PlaceholderText = "Paste JobId here",
	RemoveTextAfterFocusLost = false,
	Callback = function(jobId)
		TeleportService:TeleportToPlaceInstance(game.PlaceId, jobId, Players.LocalPlayer)
	end
})

-- Copy JobId hi·ªán t·∫°i
ServerTab:CreateButton({
	Name = "Copy current JobId",
	Callback = function()
		setclipboard(game.JobId)
		Rayfield:Notify({
			Title = "JobId Copied",
			Content = "Copied the JobId of the current server to the clipboard!",
			Duration = 4,
			Image = 6035047409
		})
	end,
})
